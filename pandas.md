# Pandas

## Series系列

一个pandas Series相当于表格中的一列。它是一个可以包含任意数据类型的一维数组。

### pd.series(对象)

通过对象创建 series

返回的series值都有自己的索引号

| 参数 | 值 | 描述 |
| --- | --- | --- |
| index | 数组 | 创建标签（索引值），可以通过index指定包含在series里的项目 |


### series.dt

可用于访问像datetime一样的series的值，并返回多个属性。

#### series.dt.date

#### series.dt.date.today()

#### series.dt.month

返回一个numpy数组，其中包含给定series对象的日期的月份

### series.str.strip（‘要删除的字符’）

删除字符


## 数据框

Pandas中的数据集通常是多维表，称为DataFrames

### Pd.dataframe()

一个pandas数据框是一个二维的数据结构，像一个二维数组，或者一个拥有行和列的表格。

| 参数 | 值 | 描述 |
| --- | --- | --- |
| ascending | True，False | 默认true。按升序分类 |
| --- | --- | --- |

字典到数据框

数据框是pandas最重要的数据结构。它基本上是一种存储表格数据的方法，你可以在其中标记行和列。

构建数据框的方式之一是从字典中获取。


## CSV到数据框read

把数据放到一个字典里然后建立数据框可行，但是没有有效。

大多数文件都是放在csv文件里，csv是用逗号隔开的值的缩写。

要将csv数据作为pandas数据框导入到python，你可以使用read_csv（）

### Pd.read_csv("文件名.csv")

| 参数 | 值 | 描述 |
| --- | --- | --- |
| index_col | 整数、字符串、false | 默认为none。作为数据框标签的列。如果为false，可以强制pandas不使用第一列作为标签 |
| parse_dates | 布尔或列表 | 【1，2，3】表示第一二三列 |
| chunksize | 数字 | 存储量大小 |


## 方括号

1、用于选择列

你可以以多种形式索引并选择pandas数据框，最简单的就是使用方括号。

单方括号版本提供pandas series，双括号版本提供pandas数据框。如果在一个数据框里选择多列，必须用双方括号

2、用于选择行或对象

数据框名【数字1:数字2】



## pd.Timestamp()

pandas替代phthon datetime.datetime对象。


## 比较运算符

当两个字符串进行比较时，python根据字母顺序确定大小。

## 布尔运算符and，or，not

布尔值为0或1，true或false。

not等级比and和or高，会先执行。

布尔运算符和 **Numpy**

为了和Numpy使用这些运算符，我们需要np.logical\_and（）、np.logical\_or（）、np.logical\_not（）

**Iterrows** （）

每次运行时Iterrows（）产生的行数是pandas系列。


# 增加行

方法一

For lab,row in 数据框名.iterrows（）：

数据框名.loc[lab,增加行名]=增加行的内容

方法二

Apply（）

数据框名["增加行名"]=数据框名["列名"].apply（增加行的内容）


### Merge()

数据框1.merge（数据框2，可选参数）

| 参数 | **值** | **描述** |
| --- | --- | --- |
| **how** | left','right','outer','inner','cross' | 默认是'inner'。指定如何合并 |
| --- | --- | --- |
| **on** | 字符串列表 | 指定在哪个区域进行合并 |
| **left\_on** | 字符串列表 | 指定在哪个级别对左侧的数据框进行合并。 |
| **suffixes** | 列表 | 指定要为重叠列添加的字符串列表。 |o
| **left\_index** | True，False | 默认false。是否使用左边数据框的索引作为共同索引 |
| **indicator** | True，False，字符串 | 默认false。是否增加带有每列资源的一列 |
| **validate** | 字符串 | 检查合并是否为指定类型 |

merge()函数通过合并两个数据框的内容来做一个新的数据框

（）查询数据框


### 数据框名.query（条件必须有）

Query（）方法允许你查询数据框。返回一个新数据框或者None。


### isnull（）找空值

数据框名.isnull（）

**count** （）

计算非空值的行数，返回带有计算结果的series

数据框名.count（axis，level，numeric\_only）

| **参数** | **值** | **描述** |
| --- | --- | --- |
| **axis** | 0，1，'index'，'columns' | 可选的，默认值是0 |
| --- | --- | --- |
| **leve** | 数字，level名 | 可选 |
| **numeric\_only** | True','False' | 可选的，默认值是false |

**sum** （）

**Agg** （）

数据框名.agg（函数）

Agg（）允许你应用一个函数或函数list沿着数据框的一个轴执行。默认值是0，也就是按行执行。如果是numpy里的函数，记得在函数前加np点。

| **参数** | **值** | **描述** |
| --- | --- | --- |
| **函数** |
 | 必须的。 |
| --- | --- | --- |
| **axis** | 0，1，'index'，'columns' | 可选的，哪个轴来执行函数。默认0 |
| **args** |
 | 可选的，发送给函数的参数 |
| **kwarg** |
 | 可选的，发送给函数的关键字参数 |

**sort\_values** （）

数据框.sort\_values（by=条件）

| **参数** | **值** | **描述** |
| --- | --- | --- |
| **ascending** | True，False | 默认true。按升序分类 |
| --- | --- | --- |
|
 |
 |
 |
|
 |
 |
 |
|
 |
 |
 |

数据框 **.sort\_index** （）

| 参数 | 值 | 描述 |
| --- | --- | --- |
| ascending | True，False或True和False的列表 | 默认true。按升序分类 |
| --- | --- | --- |
| Level | 字符串、数字、字符串和数字的列表 | 指定要排序的索引级别 |

### isin（）

数据框.isin（值）

查看数据框是否含有某个特定值。返回一个类似于原数据框的数据框，但是原始数据已经被true或false代替。

值可以是列表、字典、series和数据框。

### groupby（）

数据框名.groupby（‘要排序的列名’）【‘要使用函数的列名’】.函数（）

groupby() 方法允许您对数据进行分组并在这些组上执行函数。分组时，不仅仅可以指定一个列名，也可以指定多个列名

| 参数 | 值 | 描述 |
| --- | --- | --- |
| as_index | True，False | 默认为true。设置为false如果结果不是用组标签作为索引。 |
| --- | --- | --- |


### concat（）

竖着串联多个表。

pd.concat（【表1，表2，等】，参数）

ignore\_index=True参数表示不是用原表的索引

### append（）添加数据框

现有数据框.append（添加数据框）

把一个类数据框对象添加到现有数据框后面。

| **参数** | **值** | **描述** |
| --- | --- | --- |
| **sort** | true，false | 默认false。如果是true，分类列 |
| --- | --- | --- |
|
 |
 |
 |
|
 |
 |
 |
|
 |
 |
 |

**merge\_ordered** （）

pd.merge\_ordered（数据框1，数据框2）

用于合并两个之间存在完全匹配的，并且有有序数据的表，

fill\_method参数'ffill'表示向前填充

**Merge\_asof** （）

pd.merge\_asof（数据框1，数据框2）

类似于merge\_odered（）左合并。根据最近的关键列来合并，而且不完全合并。

用于合并有序数据，但是表格之间不需要完全匹配。

on=的列名必须是已分类的。

### Pivot（）

Pivot（）函数用于重塑一个给定的由索引/列值组织的数据框。无法聚合。

**数据框.pivot（columns=''）**

| 参数 | 值 | 描述 |
| --- | --- | --- |
| index | 字符串或对象 | 用于创建新框架索引的列。如果没有，则使用现有索引 |
| columns | 列名、数组、列表 | --- |
| values | 字符串、对象或表单 | 用于填充新框架值的列。如果未指定，则使用所有剩余的结果有分层索引的列 |
| margins | 布尔 | 增加一行/列 |

### pivot_table(数据)可以聚合

创建电子表格数据透视表作为数据框

| 参数 | 值 | 描述 |
| --- | --- | --- |
| aggfunc | 函数，函数列表，字典 | 默认mean |
| values | --- | 要聚合的列 |
| Index | 列，组 |--- | 
| columns | 列，组，数组，列表 | --- |
| fill_value | 标量 | 用于填充缺失值的值，默认值为None |
| margins | bool | 默认False。增加一行或列。 |



### crosstab()

计算两个（或更多）因子的简单交叉表。



### Melt（）

| 参数 | 值 | 描述 |
| --- | --- | --- |
| id\_vars | 元祖、列表、数组 | 指定要用做标识符的一列或多列，保持原样的列 |
| --- | --- | --- |
| value\_vars
 | 元祖、列表、数组 | 指定要逆透视的列 |
| var\_name | 字符串 | 指定variable列的标签，默认variable |


### pd.to\_datetime(要转换的对象)

把一个类标量类数组series或者数据框转化成pandas日期时间格式。

| 参数 | 值 | 描述 |
| --- | --- | --- |
| utc | bool | 默认为None,控制与时区相关的解析、本地化和转换 |


### Dropna()

dropna() 方法删除包含NULL 值的行。

### **Value\_counts** （）

数据框.value\_counts（）

该函数用于获取包含唯一独特值计数的series

结果对象是降序的，那么第一个元素会是最频繁发生的元素（包括空值）

列名可以放在数据框名后面，则对该列进行计数。

| **参数** | **值** | **描述** |
| --- | --- | --- |
| **normalize** | 布尔 | 如果为真对象返回每个不一样值的出现频率 |
| --- | --- | --- |
| **Sort** | 布尔 | 按频率陪列 |
| **ascending** | 布尔 | 按升排列，默认是降序（多的在前面） |
| **dropna** | 布尔 | 不包括空值 |
| **bins** | 整数 | IR而不是计数值，将它们分组到半开箱中，这是pd.cut的便利，仅适用于数字数据。 |

**index** （）

返回数据框的索引信息，包括行标签。如果行没有名字标签，返回系列索引对象（start，stop和step values）。

数据框**.

\_index(**'索引值'**)**

让一列或多列的值成为行索引。

数据框 **.Sample** （）

返回一个特定数的随机列。

| **参数** | **值** | **描述** |
| --- | --- | --- |
| **数字** |
 | 返回几列。默认值是一列 |
| --- | --- | --- |
| **replace** | 布尔 | 默认false。是否要重复返回统一列 |

数据框 **. reset\_index** （ **'** 列名 **'** ）

把索引值从新设回到默认的0、1、2等。

该函数默认将老索引存储在一列名为'index'的列，为了避免，可以使用drop参数。

| Drop | True，False | 默认false |
| --- | --- | --- |
|
 |
 |
 |
|
 |
 |
 |
|
 |
 |
 |
|
 |
 |
 |
|
 |
 |
 |
|
 |
 |
 |
|
 |
 |
 |

### 数据框.Cumsum（）

返回一个数据框，其中包含每一行的累计和。


### 数据框.Astype（'数据类型'）

返回一个新的数据框，它所有列的数据类型都被设为某个或某些特定类型.

你可以把整个数据框设为同一类型，或者你可以使用字典功能来给每列设定类型。

### Help（np.函数名）

### 数据框 .mode （）

返回每列的模式值。模式值是一组中最常出现的值，可以是多个值。并且会带上索引值。

| 参数| 值 | 描述 |
| --- | --- | --- |
| Axis | 0,1,索引，列名 | 默认0 |
| --- | --- | --- |

### Quantile（）

计算给定轴中值的分位数。

### 数据框.Drop_duplicates（）

从数据框里去除重复行

| **参数** | **值** | **描述** |
| --- | --- | --- |
| **Subset** | 列标签 | 包含找重复值的列的字符串或者列表。没有该项则应用于所有行。 |
| --- | --- | --- |


### any()

any() 方法为每一列返回一个值，如果该列中的任何值是True，则为True，否则为False。

### 数据框.Sample （）

返回一个随机行里的随机数，如果没有指定则返回随机行

| 参数 | 值 | 描述 |
| --- | --- | --- |
| **N** |
 | 返回几行，默认为1 |
| --- | --- | --- |
| **replace** | TrueFalse | 默认False。 |



# 清洁数据

## 清洁错误数据

### 寻找关系

寻找数据框每列之间的关系

数据框名.corr（）

寻找数据框某列和某列之间的关系

数据框名【’列名1‘】.corr（数据框名【’列名2‘】）

Corr（）计算每列之间的关系，会忽略非数字值

### 解释结果

corr（）的结果是一个有很多数字的表格

数字是在-1到1之间

1表示这是一个1对1的关系（完美相关）。每次一列的值增加，另外一列也会增加。

-0.9表示相关性很大，但是是负相关。

0.2几乎没有相关性。至少要0.6才能算有相关性。

## 去除重复值

### 数据框.duplicate()

某行返回True意味着发现重复值，返回False表示没有重复

| 参数 | 值 | 描述 |
| --- | --- | --- |
| inplace | 布尔 | 设为真则不会产生一个新的数据框，而是删除现有数据框的重复值 |
| subset | 列标签 | 包含要忽略的任何列的字符串或列表 |
| keep | first或last或False | 默认first，指定要保留的副本。 如果为 False，则删除所有重复项 |



# 画图

数据框.Plot（）

**Plt.legend()**

在轴上放置图例

1. 自动检测要在图例中显示的元素
2. 在图例中明确列出艺术家和标签

Plt.legend（【标签1，标签2】）

1. 明确列出传说中的艺术家
2. 标记现有绘图元素

| 参数 | 值 | 描述 |
| --- | --- | --- |
| handles | 艺术家序列 | 要添加到图例的艺术家（线条、补丁）列表。 |
| labels | 字符串列表 | 显示在艺术家旁边的标签列表。 |


## 散点图

使用kind='scatter'参数

散点图需要x轴和y轴：x=""，y=""

## 柱状图

数据框【'列名'】.plot（kind='hist'）

柱状图只需要一列。


# 数据框参考

### 数据框.nlargest（几行）

返回指定数量的行，在按指定列的最大值对数据框进行排序后，从顶部开始

### 数据框.tail（）

返回一定数量的最后5行或者指定n行。

### 数据框.std()

返回指定轴的标准差

### 数据框.unique()

返回每**列**的唯一值的数量

### 数据框.nsmallest(几行)

返回指定数量的行，在按指定列的最小值对 DataFrame 进行排序后从顶部开始。

| 参数 | 值 | 描述 |
| --- | --- | --- |
| columns | --- | 一个字符串（列标签）或列标签列表，指定要排序的列 |

### 数据框.filter（）

过滤数据框，返回过滤器中指定的行或列。

### 数据框.dtypes()

返回数据框中每列的数据类型

### 数据框.info()

打印出数据框的信息: 有几列、列标签、列数据类型、内存使用、系列序列、每列中的单元格数（非空值）。

### 数据框.describe()

返回数据框统计信息

如果 DataFrame 包含数字数据，则描述包含每列的以下信息：

count - 非空值的数量。

mean - 平均值。

std - 标准偏差。

min - 最小值。

25% - 25% 百分位数

50% - 50% 百分位数

75% - 75% 百分位数

max - 最大值。

### 数据框.drop()

删除指定行或列

| 参数 | 值 | 描述 |
| --- | --- | --- |
| inplace | 布尔 | 默认为False，如果为真，则对现有的数据框进行删除。如果为假，则返回一个删除后的拷贝数据框 |


### 数据框.loc()

loc属性获取或设置指定标签的值。loc是基于标签的，这意味着你必须根据行和列标签指定行和列。 Pandas使用loc来返回一行或者多行。

数据框.loc【】

得到某索引值相对应的值。

定位某值

数据框.loc【'行标签'，'列名'】

访问多行

数据框.loc【【'行标签1'，'行标签2'】】

访问多列

数据框.loc【【'行标签1'，'行标签2'】】，【【列1，列2】】

选择区域

数据框.loc【'行标签1'：'行标签2'】

注意：行标签1和行标签2都包括在结果中。


数据框 **.iloc**

iloc属性获取或设置指定索引的值。iloc是基于整数索引的，所以你需要通过整数索引指定行和列。

定位某值

数据框.iloc【行，列】

访问多行

数据框.iloc【【行1，行2，等】】

访问多列

数据框.iloc【【行1，行2】，【列1，列2】】

要访问部分行和部分列

数据框.iloc【行1：行2，列1：列2】

使用from和to指定数据框的一部分

数据框.iloc【行1：行2】
